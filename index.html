<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Stock Manual G5000 - Standalone</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(120deg, #f8fafc 0%, #e2e8f0 100%);
      padding: 20px;
    }

    .container {
      max-width: 480px;
      margin: 2rem auto;
      background: #fff;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 4px 28px rgba(163, 191, 250, 0.2);
    }

    h2 {
      text-align: center;
      margin-bottom: 2rem;
      color: #475569;
    }

    label {
      display: block;
      margin-top: 1.2rem;
      margin-bottom: 0.35rem;
      color: #64748b;
      font-weight: 600;
    }

    select,
    input[type="number"],
    input[type="text"] {
      width: 100%;
      padding: 0.7rem 1rem;
      border-radius: 0.65rem;
      border: 1px solid #dce1e7;
      font-size: 1rem;
      box-sizing: border-box;
    }

    .btn-group {
      display: flex;
      gap: 1rem;
      margin-top: 1.5rem;
    }

    button {
      flex: 1;
      padding: 0.75rem 0;
      border: none;
      border-radius: 0.75rem;
      font-weight: 700;
      color: #fff;
      font-size: 1.1rem;
      cursor: pointer;
      transition: background 0.2s ease;
    }

    button#btn-in {
      background: #22d3ee;
    }

    button#btn-in:hover {
      background: #0ea5e9;
    }

    button#btn-out {
      background: #f87171;
    }

    button#btn-out:hover {
      background: #dc2626;
    }

    .status {
      margin-top: 1rem;
      text-align: center;
      color: #334155;
      font-weight: 600;
      min-height: 1.3em;
    }

    @media(max-width: 540px) {
      .container {
        padding: 1rem 1.5rem;
      }

      .btn-group {
        flex-direction: column;
      }

      button {
        width: 100%;
        margin-top: 10px;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <h2>Stock Manual G5000</h2>

    <label for="jenisBarang">Jenis Barang</label>
    <select id="jenisBarang" aria-label="Jenis Barang">
      <option value="">-- Pilih Jenis Barang --</option>
      <option value="elektronik">Elektronik</option>
      <option value="peralatan">Peralatan</option>
      <option value="makanan">Makanan</option>
    </select>

    <label for="namaBarang">Nama Barang</label>
    <select id="namaBarang" aria-label="Nama Barang" disabled>
      <option value="">-- Pilih Nama Barang --</option>
    </select>

    <label for="qty">Jumlah Qty</label>
    <input type="number" id="qty" min="1" placeholder="Masukkan jumlah" aria-label="Jumlah" />

    <label for="checker">Nama Checker</label>
    <input type="text" id="checker" placeholder="Nama checker" aria-label="Checker" />

    <div class="btn-group">
      <button id="btn-in">Barang Masuk</button>
      <button id="btn-out">Barang Keluar</button>
    </div>

    <div class="status" id="status"></div>
  </div>

  <script>
    // Data barang per jenis, bisa diedit sesuai kebutuhan frontend
    const NAMA_BARANG = {
      elektronik: ['Handphone', 'Laptop', 'TV'],
      peralatan: ['Obeng', 'Tang', 'Palumas'],
      makanan: ['Teh', 'Kopi', 'Gula']
    };

    const jenisBarangEl = document.getElementById('jenisBarang');
    const namaBarangEl = document.getElementById('namaBarang');
    const qtyEl = document.getElementById('qty');
    const checkerEl = document.getElementById('checker');
    const statusEl = document.getElementById('status');

    // Ganti ini dengan URL Web App hasil deploy Google Apps Script backend Anda
    const BACKEND_URL = 'https://script.google.com/macros/s/AKfycbzkzDGWsZWtYTb9GE4F9MehmYjZpIO1vrv4DZ6V9uSzOLPibslv_EXPIrfOEXMdQmdkBw/exec';

    // Mengisi dropdown nama barang saat jenis barang dipilih
    jenisBarangEl.addEventListener('change', () => {
      const jenis = jenisBarangEl.value;
      namaBarangEl.innerHTML = '<option value="">-- Pilih Nama Barang --</option>';

      if (jenis && NAMA_BARANG[jenis]) {
        NAMA_BARANG[jenis].forEach(item => {
          const opt = document.createElement('option');
          opt.value = item;
          opt.textContent = item;
          namaBarangEl.appendChild(opt);
        });
        namaBarangEl.disabled = false;
      } else {
        namaBarangEl.disabled = true;
      }

      clearStatus();
    });

    // Fungsi clear pesan status
    function clearStatus() {
      statusEl.textContent = '';
    }

    // Fungsi kirim data ke backend
    async function submitData(tipe) {
      clearStatus();

      const jenis = jenisBarangEl.value;
      const namaProduk = namaBarangEl.value;
      const qty = qtyEl.value;
      const checker = checkerEl.value.trim();

      if (!jenis) return statusEl.textContent = 'Mohon pilih jenis barang.';
      if (!namaProduk) return statusEl.textContent = 'Mohon pilih nama barang.';
      if (!qty || qty < 1) return statusEl.textContent = 'Jumlah harus diisi dan minimal 1.';
      if (!checker) return statusEl.textContent = 'Mohon isi nama checker.';

      statusEl.textContent = 'Menyimpan data...';

      try {
        const response = await fetch(BACKEND_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            jenis,
            namaProduk,
            qty: Number(qty),
            checker,
            tipe
          }),
          mode: 'cors'
        });

        if (!response.ok) {
          throw new Error(`Server error: ${response.status}`);
        }

        const result = await response.json();

        if (result.result === 'success') {
          statusEl.textContent = `Data barang ${tipe === 'in' ? 'masuk' : 'keluar'} berhasil disimpan!`;
          qtyEl.value = '';
          checkerEl.value = '';
        } else {
          statusEl.textContent = `Gagal menyimpan data: ${result.message || 'Tidak diketahui'}`;
        }

      } catch (error) {
        console.error('Fetch error:', error);
        statusEl.textContent = 'Gagal menyimpan data. Periksa koneksi atau hubungi admin.';
      }
    }

    document.getElementById('btn-in').addEventListener('click', () => submitData('in'));
    document.getElementById('btn-out').addEventListener('click', () => submitData('out'));

    // Bersihkan status saat edit input agar UI responsif
    [jenisBarangEl, namaBarangEl, qtyEl, checkerEl].forEach(el => el.addEventListener('input', clearStatus));
  </script>
</body>

</html>
